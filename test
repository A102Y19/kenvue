def download_PAK_file(driver, file_name):
    logging.info(f" üîç Searching for file: {file_name} to download...")

    try:
        file_element = WebDriverWait(driver, 20).until(
            EC.presence_of_element_located(
                (By.XPATH, f"//span[@role='gridcell' and @aria-labelledby='genfilename' and text()='{file_name}']")
            )
        )
        driver.execute_script("arguments[0].click();", file_element)
        logging.info(f" üìÇ File '{file_name}' selected, opening preview...")

        # Wait for download button
        WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.XPATH, "//i[contains(@class, 'fa-download')]"))
        )

        # Click download
        download_button = WebDriverWait(driver, 10).until(
            EC.element_to_be_clickable((By.XPATH, f"//span[text()='{file_name}']//following::i[contains(@class, 'fa-download')][1]"))
        )
        driver.execute_script("arguments[0].click();", download_button)
        logging.info(f" ‚¨áÔ∏è Download initiated for file: '{file_name}'")

        # Confirm download
        download_path = get_download_path()
        download_file_path = os.path.join(download_path, file_name)

        timeout = 60  # max 5 minutes
        while timeout > 0:
            if os.path.exists(download_file_path):
                logging.info(f" ‚úÖ Download confirmed: '{file_name}' is in {download_path}")
                return download_file_path   # üëà function exit here
            elif os.path.exists(download_file_path + ".crdownload"):
                logging.info(f" ‚è≥ File is still downloading... {timeout*5}s left")
            else:
                logging.info(" ‚ùå File not found yet...")

            time.sleep(5)
            timeout -= 1

        logging.info(f" ‚ùå Download failed: '{file_name}' not found in {download_path}")
        return None

    except Exception as e:
        logging.error(f" ‚ö†Ô∏è Error: Unable to download file '{file_name}' - {e}")
        sys.exit("Unable to Download file check filename")
