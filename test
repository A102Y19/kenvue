omp_window = get_stable_omp_window()
if not omp_window:
    logging.warning("OMP window not detected. Retrying in background...")

while True:
    if omp_window and not is_window_valid(omp_window):
        omp_window = get_stable_omp_window()

    if omp_window:
        try:
            panes = omp_window.descendants()
            for pane in panes:
                name = pane.element_info.name.lower()
                text = pane.window_text().lower()
                if "information" in name or "information" in text:
                    logging.info(f"Information popup found: {text}")
                    pyautogui.press("enter")
                    logging.info("ENTER sent to close popup.")
                    # Handle Notepad if opened
                    return
        except Exception as e:
            logging.warning(f"Error scanning OMP window descendants: {e}")

    time.sleep(10)  # Retry every 10 seconds
